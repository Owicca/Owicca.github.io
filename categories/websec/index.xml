<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Websec on Down the wabbit's hole</title><link>https://www.dinudev.com/categories/websec/</link><description>Recent content in Websec on Down the wabbit's hole</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Wed, 07 Sep 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://www.dinudev.com/categories/websec/index.xml" rel="self" type="application/rss+xml"/><item><title>OTW Natas14</title><link>https://www.dinudev.com/journey/otw_natas14/</link><pubDate>Wed, 07 Sep 2022 00:00:00 +0000</pubDate><guid>https://www.dinudev.com/journey/otw_natas14/</guid><description>steps: sqlinjection: user: 1 pass: 1&amp;quot; or &amp;quot;1&amp;quot;=&amp;quot;1 lessons:</description></item><item><title>OTW Natas15</title><link>https://www.dinudev.com/journey/otw_natas15/</link><pubDate>Wed, 07 Sep 2022 00:00:00 +0000</pubDate><guid>https://www.dinudev.com/journey/otw_natas15/</guid><description>steps: lessons:</description></item><item><title>OTW Natas16</title><link>https://www.dinudev.com/journey/otw_natas16/</link><pubDate>Wed, 07 Sep 2022 00:00:00 +0000</pubDate><guid>https://www.dinudev.com/journey/otw_natas16/</guid><description>steps: [: start condition ;: multiple commands on the same line |: pipe to next command &amp;amp;: run two commands ': single quote &amp;quot;: double quote blind bash injection, you can inject a string in the regex that results from a bash subshell result doomed$(grep a /etc/natas_webpass/natas17) lessons:</description></item><item><title>OTW Natas18</title><link>https://www.dinudev.com/journey/otw_natas18/</link><pubDate>Wed, 07 Sep 2022 00:00:00 +0000</pubDate><guid>https://www.dinudev.com/journey/otw_natas18/</guid><description>steps: blind sql injection, by asking binary questions select * from users where username=&amp;quot;natas18&amp;quot; and password binary like &amp;quot;%a%&amp;quot; and sleep(2)--, if the request duration is longer than 2 seconds(the sleep triggered), it means the leter is contained in the password after gathering all the containing characters, select * from users where username=&amp;quot;natas18&amp;quot; and password binary like &amp;quot;a8n5%&amp;quot; and sleep(2)--, find the password(incrementally) starting from the first letters, based on the found containing characters lessons:</description></item><item><title>OTW Natas19</title><link>https://www.dinudev.com/journey/otw_natas19/</link><pubDate>Wed, 07 Sep 2022 00:00:00 +0000</pubDate><guid>https://www.dinudev.com/journey/otw_natas19/</guid><description>steps: lessons: 3335332d61646d696e 3 62d61646d696e 3 4312d61646d696e 3539372d61646d696e 3133302d61646d696e 3237392d61646d696e 3338352d61646d696e 3439302d61646d696e 3533302d61646d696e 3231342d61646d696e
curl &amp;lsquo;http://natas19.natas.labs.overthewire.org/index.php' -X POST -H &amp;lsquo;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:104.0) Gecko/20100101 Firefox/104.0&amp;rsquo; -H &amp;lsquo;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,/;q=0.8&amp;rsquo; -H &amp;lsquo;Accept-Language: en,en-US;q=0.7,en-GB;q=0.3&amp;rsquo; -H &amp;lsquo;Accept-Encoding: gzip, deflate&amp;rsquo; -H &amp;lsquo;Referer: http://natas19.natas.labs.overthewire.org/index.php?debug=1' -H &amp;lsquo;Content-Type: application/x-www-form-urlencoded&amp;rsquo; -H &amp;lsquo;Origin: http://natas19.natas.labs.overthewire.org&amp;rsquo; -H &amp;lsquo;DNT: 1&amp;rsquo; -H &amp;lsquo;Authorization: Basic bmF0YXMxOTo4TE1KRWhLRmJNS0lMMm14UUtqdjBhRURkazd6cFQwcw==&amp;rsquo; -H &amp;lsquo;Connection: keep-alive&amp;rsquo; -H &amp;lsquo;Cookie: __utma=176859643.325646147.1664460162.1664460162.1664460162.1; __utmc=176859643; __utmz=176859643.1664460162.1.1.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided)&amp;rsquo; -H &amp;lsquo;Upgrade-Insecure-Requests: 1&amp;rsquo; &amp;ndash;data-raw &amp;lsquo;username=admin&amp;amp;password=admin&amp;rsquo;</description></item><item><title>OTW Natas0</title><link>https://www.dinudev.com/journey/otw_natas0/</link><pubDate>Thu, 01 Sep 2022 00:00:00 +0000</pubDate><guid>https://www.dinudev.com/journey/otw_natas0/</guid><description>steps: check page source, the flag is present in a comment</description></item><item><title>OTW Natas1</title><link>https://www.dinudev.com/journey/otw_natas1/</link><pubDate>Thu, 01 Sep 2022 00:00:00 +0000</pubDate><guid>https://www.dinudev.com/journey/otw_natas1/</guid><description>steps: on the body tag there is an event on right-click(context menu) that returns false, blocking you from trying to inspect the page try other ways to see the source: F12, CTRL+u, etc read the page source, the flag is present in a comment</description></item><item><title>OTW Natas10</title><link>https://www.dinudev.com/journey/otw_natas10/</link><pubDate>Thu, 01 Sep 2022 00:00:00 +0000</pubDate><guid>https://www.dinudev.com/journey/otw_natas10/</guid><description>steps: exactly the same setup as natas9, but this time there is a weak filtering on user input /[;|&amp;amp;]/ we will try to hunt for /etc/natas_webpass/natas11 at the same time circumventing the filter, the filter denies the use of: ;: multiple commands on the same line |: piping &amp;amp;: sending a process to the background if we are stuck with the current grep, we can exploit the fact that grep can search through multiple files by aiming for a grep of the entire contents of multiple files(grep -i '.</description></item><item><title>OTW Natas11</title><link>https://www.dinudev.com/journey/otw_natas11/</link><pubDate>Thu, 01 Sep 2022 00:00:00 +0000</pubDate><guid>https://www.dinudev.com/journey/otw_natas11/</guid><description>steps: page source shows there are 4 main logic parts: encrypt some data using xor encryption 1 load the data from a cookie data store an array to the same data cookie if showpassword is yes, show the flag to show the flag we need showpassword set to yes: we can&amp;rsquo;t modify the default data the default data is overwriten by the data in the data cookie we need to write a script that uses an array with &amp;ldquo;showpassword&amp;rdquo; set to &amp;ldquo;yes&amp;rdquo;,</description></item><item><title>OTW Natas12</title><link>https://www.dinudev.com/journey/otw_natas12/</link><pubDate>Thu, 01 Sep 2022 00:00:00 +0000</pubDate><guid>https://www.dinudev.com/journey/otw_natas12/</guid><description>steps: we once again get access to the source code the source has a bunch of logic but the only usefull one is the big if/else at the end and makeRandomPathFromFilename in the if at the end a filepath is generated starting from the file input value,
the file uploaded is checked to be bellow a certain size,
if the check passes the uploaded file is copied in the generated filepath.</description></item><item><title>OTW Natas13</title><link>https://www.dinudev.com/journey/otw_natas13/</link><pubDate>Thu, 01 Sep 2022 00:00:00 +0000</pubDate><guid>https://www.dinudev.com/journey/otw_natas13/</guid><description>steps: this is 90% like natas12, the difference is that exim_imagetype is used on the uploaded file,
to check if the file is a image file the solution I found is to play around with mime-type checking 1 and camouflage the img.php file in some other mime-type, such as a jpeg the camouflage, for jpeg in particular, meant I should just add a few magic bytes to the start of the file: ff d8 ff e0 generate the fake jpeg 23 and follow the natas12 flow to upload the file and get the contents of natas14 file lessons: always mime-check uploaded files almost always uploaded files are data, so store them in data folders and</description></item><item><title>OTW Natas2</title><link>https://www.dinudev.com/journey/otw_natas2/</link><pubDate>Thu, 01 Sep 2022 00:00:00 +0000</pubDate><guid>https://www.dinudev.com/journey/otw_natas2/</guid><description>steps: check the page source the only relevant info in the body is a link to a 1x1 png image going further up the folder to see what other files are there we discover a users.txt that among other users contains the flag lessons: disable autoindex if autoindex is needed, think carefuly what data you might be exposing to the public</description></item><item><title>OTW Natas3</title><link>https://www.dinudev.com/journey/otw_natas3/</link><pubDate>Thu, 01 Sep 2022 00:00:00 +0000</pubDate><guid>https://www.dinudev.com/journey/otw_natas3/</guid><description>steps: check the page source a comment hints that &amp;ldquo;Not even Google&amp;rdquo; will find the flag, the hint refers to the way google indexes websites1 by accessing /robots.txt we see a particular dir is dissalowed(bots shouldn&amp;rsquo;t crawl it), /s3cr3t/ the dir contains a file that contains the flag lessons: making a dir public but dissalowing it does not mean malicious actors (hackers, osint analysts, curious entities, bots that ignore robots.txt) won&amp;rsquo;t access it Google indexes websites by following links from external sites that point to your website(backlinks).</description></item><item><title>OTW Natas4</title><link>https://www.dinudev.com/journey/otw_natas4/</link><pubDate>Thu, 01 Sep 2022 00:00:00 +0000</pubDate><guid>https://www.dinudev.com/journey/otw_natas4/</guid><description>steps: The page says the access is allowed only from natas5 i presume the page reads the referer, so after a quick curl request modeled on the /index.php request from the link in the page1 we get a page that contains the flag lessons: some headers are controlled by the user, don&amp;rsquo;t rely on them: User-Agent Referrer A curl request with the Referer modified to natas5:
curl &amp;#39;http://natas4.natas.labs.overthewire.org/index.php&amp;#39; \ -H &amp;#39;Authorization: Basic &amp;lt;basic_auth_token_here&amp;gt;&amp;#39; \ -H &amp;#39;Referer: http://natas5.</description></item><item><title>OTW Natas5</title><link>https://www.dinudev.com/journey/otw_natas5/</link><pubDate>Thu, 01 Sep 2022 00:00:00 +0000</pubDate><guid>https://www.dinudev.com/journey/otw_natas5/</guid><description>steps: The page says the access is dissalowed because we are not logged in nothing stands out in page source in the requests headers we see a particularly named cookie loggedin with value 0 after changing the value of the cookie to 1 1 and a refresh we get the flag lessons: cookies are used to store state, but their content is fully controlled by the user encrypt cookies ignore invalid cookies Set the cookie to 1:</description></item><item><title>OTW Natas6</title><link>https://www.dinudev.com/journey/otw_natas6/</link><pubDate>Thu, 01 Sep 2022 00:00:00 +0000</pubDate><guid>https://www.dinudev.com/journey/otw_natas6/</guid><description>steps: there is a link that points to the php source code of the page php script includes a certain /includes/secret.inc, then checks if a $secret value is equal to our input if we access the /includes/secret.inc page and check the source we see the variable definition using the value from $secret for the input and we get the flag lessons: don&amp;rsquo;t leave private/internal data in page comments be carefull what endpoints you expose to the internet</description></item><item><title>OTW Natas7</title><link>https://www.dinudev.com/journey/otw_natas7/</link><pubDate>Thu, 01 Sep 2022 00:00:00 +0000</pubDate><guid>https://www.dinudev.com/journey/otw_natas7/</guid><description>steps: by checking the page source we get a hint(a path) from the comment where the flag might be the two links in the page have a page param, that probably specifies the path of the html page to be loaded by trying some random paths as page value we get errors that hits towards a path/directory transversal 1 by using the path in the comments as url param value /index.</description></item><item><title>OTW Natas8</title><link>https://www.dinudev.com/journey/otw_natas8/</link><pubDate>Thu, 01 Sep 2022 00:00:00 +0000</pubDate><guid>https://www.dinudev.com/journey/otw_natas8/</guid><description>steps: a input is present and a link to the source code, the source code reveals the input is processed through a function and compared to a static value create a function that runs the operations in the oposite direction 1, modeled by the function from the source by sending the static value found in the source code through our function we get the initial input use the initial input in the page and we will get the flag lessons: this is probably a simple introduction to hashing &amp;lt;?</description></item><item><title>OTW Natas9</title><link>https://www.dinudev.com/journey/otw_natas9/</link><pubDate>Thu, 01 Sep 2022 00:00:00 +0000</pubDate><guid>https://www.dinudev.com/journey/otw_natas9/</guid><description>steps: the page searches for an input in a particular file the code source shows the user input is sent without validation through a php passthru to the os, this hints to a shell injection 1 by sending a .* we get the entire contents of the file by sending ; id; we get the php user remembering from natas description that All passwords are also stored in /etc/natas_webpass/., we try ; cat /etc/natas_webpass/natas10; and get the flag lessons: never use raw user input if you are forced to use user input, sanitize it before using Shell injection allows the user to run arbitrary commands on the server os.</description></item></channel></rss>