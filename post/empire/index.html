<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="OWicca">
  <meta name="generator" content="Hugo 0.69.0-DEV" />
  <title>Empire Framework Notes — Down the wabbit&#39;s hole</title>

  <meta name="description" content="">
  <link rel="canonical" href="https://www.dinudev.com/post/empire/">
  <link href="" rel="alternate"
    type="application/rss+xml" title="Down the wabbit&#39;s hole">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Arvo:400,700">
  <link rel="stylesheet" href="https://www.dinudev.com/css/highlight.css">
  <link rel="stylesheet" href="https://www.dinudev.com/css/paperback.css">
  <link rel="stylesheet" href="https://www.dinudev.com//main.css">
</head>


<body>
  <div class="container">

    <header>
  
  <h1>Empire Framework Notes</h1>

  
  <time datetime="2020-02-26 12:37:00 &#43;0200 EET">2020/02/26</time>
  

  
  <nav class="site-nav">
  <a href="/">Home</a>
  <a href="/post/">All posts</a>

  

  

  
</nav>

</header>

	
	
	<h3>Table of Contents</h3>
	<aside>
		<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#setup">setup:</a></li>
        <li><a href="#architecture">architecture:</a></li>
        <li><a href="#features">features:</a></li>
      </ul>
    </li>
  </ul>
</nav>
	</aside>
	
    <article>
      <h3 id="setup">setup:</h3>
<ul>
<li>based on some distro detection techniques,
install prerequisites and powershell(.dotnetcore)</li>
<li>works with python 2 and/or 3</li>
<li>setup database from <code>setup/setup_database.py</code>:
<ul>
<li>sqlite3</li>
<li>setup users and passwords:
<ul>
<li>
<table>
<thead>
<tr>
<th align="right">config:</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">staging_key</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">install_path</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">ip_whitelist</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">ip_blacklist</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">autorun_command</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">autorun_data</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">rootuser</td>
<td align="right">boolean</td>
</tr>
<tr>
<td align="right">api_username</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">api_password</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">api_current_token</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">api_permanent_token</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">obfuscate</td>
<td align="right">integer</td>
</tr>
<tr>
<td align="right">obfuscate_command</td>
<td align="right">text</td>
</tr>
</tbody>
</table>
</li>
<li>
<table>
<thead>
<tr>
<th align="right">agents:</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">id</td>
<td align="right">integer</td>
</tr>
<tr>
<td align="right">session_id</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">listener</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">name</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">language</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">language_version</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">delay</td>
<td align="right">integer</td>
</tr>
<tr>
<td align="right">jitter</td>
<td align="right">real</td>
</tr>
<tr>
<td align="right">external_ip</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">internal_ip</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">username</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">high_integrity</td>
<td align="right">integer</td>
</tr>
<tr>
<td align="right">process_name</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">process_id</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">hostname</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">os_details</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">session_key</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">nonce</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">checkin_time</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">lastseen_time</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">parent</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">children</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">servers</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">profile</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">functions</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">kill_date</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">working_hours</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">lost_limit</td>
<td align="right">integer</td>
</tr>
<tr>
<td align="right">taskings</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">results</td>
<td align="right">tex</td>
</tr>
</tbody>
</table>
</li>
<li>
<table>
<thead>
<tr>
<th align="right">listeners:</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">id</td>
<td align="right">integer</td>
</tr>
<tr>
<td align="right">name</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">module</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">listener_type</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">listener_category</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">enabled</td>
<td align="right">boolean</td>
</tr>
<tr>
<td align="right">options</td>
<td align="right">blo</td>
</tr>
</tbody>
</table>
</li>
<li>
<table>
<thead>
<tr>
<th align="right">credentials:</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">id</td>
<td align="right">integer</td>
</tr>
<tr>
<td align="right">credtype</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">domain</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">username</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">password</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">host</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">os</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">sid</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">notes</td>
<td align="right">tex</td>
</tr>
</tbody>
</table>
</li>
<li>
<table>
<thead>
<tr>
<th align="right">taskings:</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">id</td>
<td align="right">integer</td>
</tr>
<tr>
<td align="right">data</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">agent</td>
<td align="right">text</td>
</tr>
</tbody>
</table>
</li>
<li>
<table>
<thead>
<tr>
<th align="right">results:</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">id</td>
<td align="right">integer</td>
</tr>
<tr>
<td align="right">data</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">agent</td>
<td align="right">text</td>
</tr>
</tbody>
</table>
</li>
<li>
<table>
<thead>
<tr>
<th align="right">reporting:</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">id</td>
<td align="right">integer</td>
</tr>
<tr>
<td align="right">name</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">event_type</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">message</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">time_stamp</td>
<td align="right">text</td>
</tr>
<tr>
<td align="right">taskID</td>
<td align="right">integer</td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
</ul>
</li>
<li>generate a self-signed certificate</li>
<li>install python req:
<ul>
<li>network tools</li>
<li>setup tools</li>
<li>cryptographic tools</li>
<li>iptools(manipulate ipv4/ip6 addresses)</li>
<li>pydispatcher(signal dispatching mechanism)</li>
<li>web framework(flask/jinja)</li>
<li>pe/macho header readers</li>
<li>dropbox(api wrapper)</li>
<li>pyOpenSSL(openssl wrapper)</li>
<li>pyinstaller(make an exe)</li>
<li>zlib_wrapper</li>
<li>netifaces(portable network interface information)</li>
<li>pyminifier(minifier,obfuscator,compressor)</li>
<li>xlutils(work with excel files)</li>
</ul>
</li>
</ul>
<h3 id="architecture">architecture:</h3>
<ul>
<li>structure:
<ul>
<li>listeners:
<ul>
<li>pivot</li>
<li>hop</li>
<li>foreign</li>
</ul>
</li>
<li>stagers(./lib/stagers/*):</li>
</ul>
</li>
</ul>
<h3 id="features">features:</h3>

    </article>

    <nav class="site-nav">
  <a href="/">Home</a>
  <a href="/post/">All posts</a>

  

  
  <a href="https://github.com/Owicca">GitHub</a>

  
</nav>


    <footer class="site-footer">
  <span class="owner">©2020 OWicca</span>

  

  
</footer>


  </div>

  
<script src="https://www.dinudev.com/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


</body>

</html>
