<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="OWicca"><meta name=generator content="Hugo 0.69.0-DEV"><title>Empire Framework Notes — Down the wabbit's hole</title><meta name=description content><link rel=canonical href=https://www.dinudev.com/post/empire/><link href rel=alternate type=application/rss+xml title="Down the wabbit's hole"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Arvo:400,700"><link rel=stylesheet href=https://www.dinudev.com/css/highlight.css><link rel=stylesheet href=https://www.dinudev.com/css/paperback.css><link rel=stylesheet href=https://www.dinudev.com//main.css></head><body><div class=container><header><h1>Empire Framework Notes</h1><time datetime="2020-02-26 12:37:00 +0200 EET">2020/02/26</time><nav class=site-nav><a href=/>Home</a>
<a href=/post/>All posts</a></nav></header><article><h3 id=setup>setup:</h3><ul><li>based on some distro detection techniques,
install prerequisites and powershell(.dotnetcore)</li><li>works with python 2 and/or 3</li><li>setup database from <code>setup/setup_database.py</code>:<ul><li>sqlite3</li><li>setup users and passwords:<ul><li><table><thead><tr><th>config:</th><th></th></tr></thead><tbody><tr><td>staging_key</td><td>text</td></tr><tr><td>install_path</td><td>text</td></tr><tr><td>ip_whitelist</td><td>text</td></tr><tr><td>ip_blacklist</td><td>text</td></tr><tr><td>autorun_command</td><td>text</td></tr><tr><td>autorun_data</td><td>text</td></tr><tr><td>rootuser</td><td>boolean</td></tr><tr><td>api_username</td><td>text</td></tr><tr><td>api_password</td><td>text</td></tr><tr><td>api_current_token</td><td>text</td></tr><tr><td>api_permanent_token</td><td>text</td></tr><tr><td>obfuscate</td><td>integer</td></tr><tr><td>obfuscate_command</td><td>text</td></tr></tbody></table></li><li><table><thead><tr><th>agents:</th><th></th></tr></thead><tbody><tr><td>id</td><td>integer</td></tr><tr><td>session_id</td><td>text</td></tr><tr><td>listener</td><td>text</td></tr><tr><td>name</td><td>text</td></tr><tr><td>language</td><td>text</td></tr><tr><td>language_version</td><td>text</td></tr><tr><td>delay</td><td>integer</td></tr><tr><td>jitter</td><td>real</td></tr><tr><td>external_ip</td><td>text</td></tr><tr><td>internal_ip</td><td>text</td></tr><tr><td>username</td><td>text</td></tr><tr><td>high_integrity</td><td>integer</td></tr><tr><td>process_name</td><td>text</td></tr><tr><td>process_id</td><td>text</td></tr><tr><td>hostname</td><td>text</td></tr><tr><td>os_details</td><td>text</td></tr><tr><td>session_key</td><td>text</td></tr><tr><td>nonce</td><td>text</td></tr><tr><td>checkin_time</td><td>text</td></tr><tr><td>lastseen_time</td><td>text</td></tr><tr><td>parent</td><td>text</td></tr><tr><td>children</td><td>text</td></tr><tr><td>servers</td><td>text</td></tr><tr><td>profile</td><td>text</td></tr><tr><td>functions</td><td>text</td></tr><tr><td>kill_date</td><td>text</td></tr><tr><td>working_hours</td><td>text</td></tr><tr><td>lost_limit</td><td>integer</td></tr><tr><td>taskings</td><td>text</td></tr><tr><td>results</td><td>tex</td></tr></tbody></table></li><li><table><thead><tr><th>listeners:</th><th></th></tr></thead><tbody><tr><td>id</td><td>integer</td></tr><tr><td>name</td><td>text</td></tr><tr><td>module</td><td>text</td></tr><tr><td>listener_type</td><td>text</td></tr><tr><td>listener_category</td><td>text</td></tr><tr><td>enabled</td><td>boolean</td></tr><tr><td>options</td><td>blo</td></tr></tbody></table></li><li><table><thead><tr><th>credentials:</th><th></th></tr></thead><tbody><tr><td>id</td><td>integer PRIMARY KEY</td></tr><tr><td>credtype</td><td>text</td></tr><tr><td>domain</td><td>text</td></tr><tr><td>username</td><td>text</td></tr><tr><td>password</td><td>text</td></tr><tr><td>host</td><td>text</td></tr><tr><td>os</td><td>text</td></tr><tr><td>sid</td><td>text</td></tr><tr><td>notes</td><td>tex</td></tr></tbody></table></li><li><table><thead><tr><th>taskings:</th><th></th></tr></thead><tbody><tr><td>id</td><td>integer</td></tr><tr><td>data</td><td>text</td></tr><tr><td>agent</td><td>text</td></tr></tbody></table></li><li><table><thead><tr><th>results:</th><th></th></tr></thead><tbody><tr><td>id</td><td>integer</td></tr><tr><td>data</td><td>text</td></tr><tr><td>agent</td><td>text</td></tr></tbody></table></li><li><table><thead><tr><th>reporting:</th><th></th></tr></thead><tbody><tr><td>id</td><td>integer</td></tr><tr><td>name</td><td>text</td></tr><tr><td>event_type</td><td>text</td></tr><tr><td>message</td><td>text</td></tr><tr><td>time_stamp</td><td>text</td></tr><tr><td>taskID</td><td>integer</td></tr></tbody></table></li></ul></li></ul></li><li>generate a self-signed certificate</li><li>install python req:<ul><li>network tools</li><li>setup tools</li><li>cryptographic tools</li><li>iptools(manipulate ipv4/ip6 addresses)</li><li>pydispatcher(signal dispatching mechanism)</li><li>web framework(flask/jinja)</li><li>pe/macho header readers</li><li>dropbox(api wrapper)</li><li>pyOpenSSL(openssl wrapper)</li><li>pyinstaller(make an exe)</li><li>zlib_wrapper</li><li>netifaces(portable network interface information)</li><li>pyminifier(minifier,obfuscator,compressor)</li><li>xlutils(work with excel files)</li></ul></li></ul><h3 id=architecture>architecture:</h3><ul><li>structure:<ul><li>listeners:<ul><li>pivot</li><li>hop</li><li>foreign</li></ul></li><li>stagers(./lib/stagers/*):</li></ul></li></ul><h3 id=features>features:</h3></article><nav class=site-nav><a href=/>Home</a>
<a href=/post/>All posts</a>
<a href=https://github.com/Owicca>GitHub</a></nav><footer class=site-footer><span class=owner>©2020 OWicca</span></footer></div><script src=https://www.dinudev.com/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>