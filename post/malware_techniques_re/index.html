<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="OWicca"><meta name=generator content="Hugo 0.80.0"><title>Malware techniques RE — Down the wabbit's hole</title><meta name=description content><link rel=canonical href=https://www.dinudev.com/post/malware_techniques_re/><link href rel=alternate type=application/rss+xml title="Down the wabbit's hole"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Arvo:400,700"><link rel=stylesheet href=https://www.dinudev.com/css/highlight.css><link rel=stylesheet href=https://www.dinudev.com/css/paperback.css><link rel=stylesheet href=https://www.dinudev.com/css/main.css></head><body><div class=container><header><h1>Malware techniques RE</h1><nav class=site-nav><a href=/>Home</a>
<a href=/post/>All posts</a>
<a href=/paper/>Papers</a></nav></header><article><h3 id=smashing-the-stack>Smashing the stack:</h3><ul><li>when you make a call, you push the address to return to onto the stack</li><li>overwrite that address</li></ul><h3 id=empire>empire:</h3><ul><li><a href=https://github.com/EmpireProject/Empire>source</a></li><li><strong>discontinued</strong> but a fork is currently mantained by <a href=https://github.com/BC-SECURITY/Empire>BC Security</a>:</li><li>launchers:<ul><li>powershell</li><li>python</li></ul></li><li>stagers:<ul><li>backdoorLnkMacro:<ul><li>backdoor .lnk on desktop that on click will attempt to download and run an empire agent</li><li>structure:<ul><li>xls file new or with data</li><li>macro to be injected into the xls</li><li>xml holds data about empire install, this will be hosted on the c2</li></ul></li><li>behaviour:<ul><li>two-stage macro:<ul><li>stage 1: vbscript that backdoors all the .lnk on the desktop to run a pshell instance the next time they are run</li><li>stage 2: backdoored link will download & execute an empire launcher from the xml, which will grant a reverse shell</li></ul></li></ul></li></ul></li></ul></li><li>obfuscation techniques:<ul><li>randomize capitalization of language keywords</li><li><a href=https://github.com/danielbohannon/Invoke-Obfuscation>powershell obfuscation</a></li></ul></li></ul></article><nav class=site-nav><a href=https://www.dinudev.com//>Home</a>
<a href=https://www.dinudev.com//post/>All posts</a>
<a href=https://www.dinudev.com//paper/>Papers</a>
<a href=https://github.com/Owicca>GitHub</a></nav><footer class=site-footer><span class=owner>©2021 OWicca</span></footer></div><script src=https://www.dinudev.com/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>