<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="OWicca"><meta name=generator content="Hugo 0.121.2"><title>HTTPd — Down the wabbit's hole</title>
<meta name=description content><link rel=canonical href=https://www.dinudev.com/post/httpd/><link href rel=alternate type=application/rss+xml title="Down the wabbit's hole"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Arvo:400,700"><link rel=stylesheet href=https://www.dinudev.com/css/highlight.css><link rel=stylesheet href=https://www.dinudev.com/css/paperback.css><link rel=stylesheet href=https://www.dinudev.com/css/main.css><link rel=stylesheet href=https://www.dinudev.com/css/tabs.css></head><body><div class=container><header><h1>HTTPd</h1><nav class=site-nav><a href=/>Home</a>
<a href=/post/>All posts</a>
<a href=/thoughts/>Thoughts</a>
<a href=/paper/>Papers</a></nav></header><h3>Table of Contents</h3><aside><nav id=TableOfContents><ul><li><ul><li><a href=#mpm-modules>mpm modules:</a></li><li><a href=#modules>modules:</a></li><li><a href=#mod-rewrite>mod rewrite:</a></li></ul></li></ul></nav></aside><article><h3 id=mpm-modules>mpm modules:</h3><ul><li>prefork:<ul><li>misc:<ul><li>a master mantains a pool of children</li><li>a bunch of children are forked from parent at the start of the parent</li><li>the parent aims to have a few idle children, always ready to handle new requests</li><li>children(<code>workers</code>) are forked as needed up to a <code>MaxRequestWorkers</code> number</li><li>the children handle the requests</li></ul></li></ul></li><li>worker:<ul><li>misc:<ul><li>same as <code>prefork</code> but each children handles a bunch of threads:<ul><li>1 listener thread: listen for new connections and pass the request to a server thread</li><li>multiple server threads: process the connection</li></ul></li><li>number of processes started is specified by <code>StartServers</code>, <code>MinSpareThreads</code>, <code>MaxSpareThreads</code></li><li>number of active child processes is <code>MaxRequestWorkers</code> / <code>ThreadsPerChild</code>:<ul><li><code>MaxRequestWorkers</code>: total workers per httpd server</li><li><code>ThreadsPerChild</code>: threads per process(<code>workers</code>)</li></ul></li></ul></li></ul></li><li>event:<ul><li>misc:<ul><li>based on <code>worker</code></li><li>listener threads handle server threads scheduling</li><li>a long-lived connection is passed to the listener that will only pass it back to a server thread if an event that allows further processing is send by the os for the connection</li><li>blocking connections are passed from the workers to the listener until they unblock,
when the unblocking event happens, the listener picks an idle worker and gives the connection for further processing</li><li>thread workload concurrency with listener as a scheduler and workers</li></ul></li></ul></li></ul><h3 id=modules>modules:</h3><ul><li>misc:<ul><li>me modules are staticly compiled with apache binary</li><li>other modules are specified in the config with <code>LoadModule</code> and loaded at runtime after a restart as shared libraries</li></ul></li><li>types:<ul><li>static:<ul><li>core</li><li>http</li></ul></li><li>shared:<ul><li>everything else</li></ul></li></ul></li><li>default modules:<ul><li><code>mod_mpm_event</code>: mpm event</li><li><code>mod_authn_core</code>:<ul><li>provides management of basic auth and http digest(?!!?) modes of authentication</li><li>submodules:<ul><li><code>mod_authn_file</code>: authentication by reading a file that contains a <code>htpasswd</code> user:pass_hash file</li><li><code>mod_auth_basic</code>: provides basic auth capabilities</li></ul></li></ul></li><li><code>mod_authz_core</code>:<ul><li>allow advanced auth logic</li><li>adds <code>Require</code></li><li>submodules:<ul><li><code>mod_authz_host</code>: provides acl based on groups(ip, host)</li><li><code>mod_authz_user</code>: allows access if user belongs to specified os user</li><li><code>mod_authz_groupfile</code>: allows access if user belongs to specified os group(or the group of a specified file)</li></ul></li></ul></li><li><code>mod_access_compat</code>: adds <code>Allow</code> and <code>Deny</code></li><li><code>mod_reqtimeout</code>: adds <code>RequestReadTimeout</code></li><li><code>mod_filter</code>: ??!!?</li><li><code>mod_mime</code>: sets metadata based on mime type(only extension??!)</li><li><code>mod_log_config</code>: adds <code>CustomLog</code> and <code>LogFormat</code> to customize log output</li><li><code>mod_env</code>: manage env values inside the request(read from os or set internal env)</li><li><code>mod_headers</code>: directly modify request and response headers</li><li><code>mod_setenvif</code>: adds <code>SetEnvIf</code> that sets env based on attributes of the request</li><li><code>mod_version</code>: adds <code>IfVersion</code> that is an if by apache version</li><li><code>mod_unixd</code>: adds <code>Group</code>, <code>User</code> and <code>ChrootDir</code> that control the user and group of the apache process</li><li><code>mod_status</code>: a debugging endpoint that shows internal server statistics</li><li><code>mod_autoindex</code>: autoindex a dir</li><li><code>mod_info</code>: a debugging endpoint that shows server configuration data</li><li><code>mod_dir</code>: specify the index file for a requested dir</li><li><code>mod_alias</code>: allows simple internal(<code>Alias</code>) and external(<code>Redirect</code>) manipulation of requested urls</li></ul></li></ul><h3 id=mod-rewrite>mod rewrite:</h3><ul><li>misc:<ul><li>allows complex manipulation of requested urls</li></ul></li></ul></article><nav class=site-nav><a href=https://www.dinudev.com//>Home</a>
<a href=https://www.dinudev.com//post/>All posts</a>
<a href=https://www.dinudev.com//thoughts/>Thoughts</a>
<a href=https://www.dinudev.com//paper/>Papers</a>
<a href=https://github.com/Owicca>GitHub</a></nav><footer class=site-footer><span class=owner>©2024 OWicca</span></footer></div><script src=https://www.dinudev.com/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad()</script><script src=https://www.dinudev.com/js/tabs.js></script></body></html>