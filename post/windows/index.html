<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="OWicca"><meta name=generator content="Hugo 0.69.0-DEV"><title>Windows — Down the wabbit's hole</title><meta name=description content><link rel=canonical href=https://www.dinudev.com/post/windows/><link href rel=alternate type=application/rss+xml title="Down the wabbit's hole"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Arvo:400,700"><link rel=stylesheet href=https://www.dinudev.com/css/highlight.css><link rel=stylesheet href=https://www.dinudev.com/css/paperback.css><link rel=stylesheet href=https://www.dinudev.com//main.css></head><body><div class=container><header><h1>Windows</h1><time datetime="2020-03-16 17:19:00 +0200 EET">2020/03/16</time><nav class=site-nav><a href=/>Home</a>
<a href=/post/>All posts</a></nav></header><article><h3 id=major-versions>Major Versions:</h3><ul><li>XP(2001) 5.1</li><li>Vista(2007) 6.0</li><li>7(2009) 6.1</li><li>8(2012) 6.2</li><li>8.1(2013) 6.3</li><li>10(2015) 10</li></ul><h3 id=component-object-modelcom>Component Object Model(COM):</h3><ul><li>originally created to enable Office apps to communicate and exchange data between documents
(Object Linking and Embedding - OLE)</li><li>principles:<ul><li>clients communicate with objects(COM server objects) through interfaces</li><li>component implementation is loaded dynamically rather than begin statically linked to the client</li></ul></li><li>it tipically refers to a DLL or EXE where the COM classes are implemented</li></ul><h3 id=windows-runtimewinrt>Windows Runtime(WinRT):</h3><ul><li>platform services aimed particularlly at app developers for Windows Apps(Windows Store Apps)</li><li>can target multiple device form factors(IoT, phones, tablets, desktops, xbox, hololens)</li><li>built on top of COM</li></ul><h3 id=net-framework>.NET Framework:</h3><ul><li>Common Language Runtime(CLR):<ul><li>a JIT that translates CIL(Common Intermediate Language) to the underlying hardware CPU machine language</li><li>a garbage collector</li><li>type verification</li><li>code access security</li><li>etc</li></ul></li><li>.Net Framework Class Library(FCL):<ul><li>large collection of types that implement functionality needed by the client or server applications:<ul><li>user interfaces</li><li>networking</li><li>database access</li><li>etc</li></ul></li></ul></li></ul><h3 id=service>Service:</h3><ul><li>a callable routine in the OS</li><li>a device driver</li><li>a server process</li></ul><h3 id=process>Process:</h3><ul><li>a program is a static sequence of instructions</li><li>a process is a container for a set of resources used when executing the instance of the program</li><li>structure:<ul><li>virtual private address</li><li>executable program: initial data and code mapped in the process&rsquo;s vm</li><li>a list of open handles: mapping to system resources
(semaphores, synchronization objects, files) accessible to all threads in the process</li><li>a security context(access token):<ul><li>user</li><li>security groups</li><li>privileges</li><li>attributes</li><li>claims</li><li>capabilities</li><li>UAC(User Account Control) virtualization state</li><li>session</li><li>limited user account state associated with the process</li><li>AppContainer identifier(and related sandboxing information)</li></ul></li><li>a process ID: unique identifier</li><li>at least one thread of execution</li></ul></li></ul><h3 id=thread>Thread:</h3><ul><li>an entity in a process Windows schedules for execution</li><li>structure:<ul><li>contents of a set of CPU registers representing the state of the processor</li><li>two stacks(one for execution in kernel mode and the other for user mode execution)</li><li>thread-local storage for use by subsystems, run-time libraries and DLLs</li><li>thread ID(unique identifier)</li><li>sometimes their own security context or token</li></ul></li><li>thread context(volatile registers, stacks and thread-local storage;
<code>GetThreadContext</code> returns a <code>CONTEXT</code>;<code>Wow64GetThreadContext</code>)</li><li>switching between two threads gets expensive:<ul><li>fibers(lightweight threads): allow an application to schedule its own threads of execution:<ul><li><code>ConvertThreadToFiber</code>;<code>CreateFiber</code>;<code>SwitchToFiber</code></li><li>they are invisible to the kernel</li><li>issues sharing thread-local storage(several fibers can be running on the same thread)</li><li>cannot run concurently on more than one processor</li></ul></li><li>user-mode scheduling threads:<ul><li>only available in x64</li></ul></li></ul></li></ul><h3 id=job>Job:</h3><ul><li>extension of a process</li><li>management and manipulation of groups of processes as a unit</li><li>compensates for the lack of a process tree</li></ul><h3 id=virtual-memory>Virtual Memory:</h3><ul><li>pages:<ul><li>default size of 4KB</li></ul></li><li>in x86:<ul><li>0x0000 0000 to 0x7FFF FFFF are used for processes</li><li>0x8000 0000 to 0xFFFF FFFF is protected for the OS</li></ul></li><li>Address Windowing Extension(AWE): 32-bit can allocate up to 64 GB of physical memory and map views
into its vm</li></ul><h3 id=terminal-services>Terminal Services:</h3><ul><li>windows equivalent to X Windowing system remote desktop</li><li>run application on a host and send the display on another</li></ul><h3 id=registry>Registry:</h3><ul><li>structure:<ul><li>system database that contains information required to boot and configure the system</li><li>system-wide software settings that control the operation of Windows</li><li>the security database</li><li>per-user configuration settings</li><li>access to in-memory volatile data</li></ul></li><li>HKEY_LOCAL_MACHINE(HKLM): system-wide configuration hive</li></ul><h3 id=security>Security:</h3><ul><li>process integrity levels:<ul><li>the process must have at least the same integrity level as the object it operates on, to be allowed to change it</li><li>hierarchy:<ul><li>system</li><li>high(eleveated administrator process)</li><li>medium(default;standard processes and objects created by the user)</li><li>low(Internet Explorer)</li><li>untrusted(Google Chrome)</li></ul></li></ul></li><li><strong>AppContainer</strong>:<ul><li>aplication sandboxing</li><li>blocks processes from writing and reading outside of its boundaries: the AppContainer</li><li>by default an app can access only its install folder and subfolders</li><li>other access paths are defined while installing(capability activation) or after, with explicit user interaction</li><li>it is a SID(security identifier)</li><li>capabilities:<ul><li>library: access to a specific library</li><li>device: access to the microphone, camera, GPS and removable storage</li><li>network: access to lan or wan</li><li>identity: access to use the user credentials</li><li>system: show notifications, show status in the backround and run in the backround when the system is locked</li></ul></li><li>apps have access to a selection of broker processes to execute certain operations outside the appcontainer boundaries</li></ul></li><li><strong>AppLocker</strong>:<ul><li>application whitelising based on path, publisher, hash or group policy:<ul><li>rules based on file attributes(publisher name, product name,
file name, file version, file path, file hash)</li><li>assign a rule to a security group or individual user</li><li>create exceptions to rules</li><li>can use audit-only mode to deploy the policy and understand its impact before inforcing it</li><li>can create and manage rules in powershell</li></ul></li><li>control which apps and files users can run</li><li>bypass techniques:<ul><li>write an unapproved program to a whitelisted location</li><li>use an whitelisted program as a delegate to launch an unapproved program</li><li>hijack the DLLs loaded by a trusted application in an untrusted directory</li></ul></li></ul></li><li><strong>Device Guard</strong>:<ul><li>block all apps that are considered to not be trusted, allows only apps from the store,
selected software vendors, and signed line-of-business applications to run</li><li>line <strong>AppLocker</strong> but it segregates the process that determines wether the apps are trusted or not</li><li>it runs in virtual secure mode with the elf of LSA(Local Security Authority),
and is isolated from the os using hardware-assisted virtualization</li><li>it won&rsquo;t be able to protect from JIT code(java, document macros)</li></ul></li><li>Microsoft <strong>Passport</strong>:<ul><li>single sign-in service</li><li>a wallet for fast, convenient online purchases</li></ul></li><li>Microsoft <strong>Hello</strong>():<ul><li>biometric authentication: face or fingerprint</li><li>pin for every device</li></ul></li><li><strong>Software Restriction Policies</strong>(SRP):<ul><li>group policy-based feature</li><li>identifies software programs running on computers in a domain</li><li>controls the ability of those programs to run</li><li><strong>local group policy editor</strong></li></ul></li></ul></article><nav class=site-nav><a href=/>Home</a>
<a href=/post/>All posts</a>
<a href=https://github.com/Owicca>GitHub</a></nav><footer class=site-footer><span class=owner>©2020 OWicca</span></footer></div><script src=https://www.dinudev.com/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>