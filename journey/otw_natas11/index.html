<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="OWicca"><meta name=generator content="Hugo 0.102.3"><title>OTW Natas11 — Down the wabbit's hole</title><meta name=description content><link rel=canonical href=https://www.dinudev.com/journey/otw_natas11/><link href rel=alternate type=application/rss+xml title="Down the wabbit's hole"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Arvo:400,700"><link rel=stylesheet href=https://www.dinudev.com/css/highlight.css><link rel=stylesheet href=https://www.dinudev.com/css/paperback.css><link rel=stylesheet href=https://www.dinudev.com/css/main.css></head><link rel=stylesheet href=https://www.dinudev.com/css/tabs.css><body><div class=container><header><h1>OTW Natas11</h1><nav class=site-nav><a href=/>Home</a>
<a href=/post/>All posts</a>
<a href=/journey/>The journey</a>
<a href=/paper/>Papers</a></nav></header><h3>Table of Contents</h3><aside><nav id=TableOfContents><ul><li><ul><li><a href=#steps>steps:</a></li><li><a href=#lessons>lessons:</a></li></ul></li></ul></nav></aside><article><h3 id=steps>steps:</h3><ol><li>page source shows there are 4 main logic parts:<ul><li>encrypt some data using xor encryption <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></li><li>load the data from a cookie <code>data</code></li><li>store an array to the same <code>data</code> cookie</li><li>if <code>showpassword</code> is <code>yes</code>, show the flag</li></ul></li><li>to show the flag we need <code>showpassword</code> set to <code>yes</code>:<ul><li>we can&rsquo;t modify the default data</li><li>the default data is overwriten by the data in the <code>data</code> cookie</li><li>we need to write a script that uses an array with &ldquo;showpassword&rdquo; set to &ldquo;yes&rdquo;,<br>encrypt the data and set the result as a cookie</li><li>this way the cookie will be decrypted, will contain &ldquo;showpassword&rdquo; = &ldquo;yes&rdquo; and get the flag</li></ul></li><li>to properly encrypt we need to find the key,<br>and we use the following property of xor: <code>encrypted XOR plain = key</code>:<ul><li>set the <code>xor_encrypt</code> key to the plain data</li><li>take the cookie data, pass it to <code>xor_encrypt</code></li><li>the result is the key, the key is smaller than the plain so it is repeated</li></ul></li><li>create the default array, and set &ldquo;showpassword&rdquo; to &ldquo;yes&rdquo;, encrypt using the key</li><li>set the resulted value as cookie, click &ldquo;submit&rdquo;</li></ol><h3 id=lessons>lessons:</h3><ul><li>learn the basics of crypto</li></ul><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://en.wikipedia.org/wiki/XOR_cipher>xor encryption</a> works as follows:</p><ul><li>plain XOR key = encrypted</li><li>encrypted XOR key = plain</li></ul>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></li></ol></div></article><nav class=site-nav><a href=https://www.dinudev.com//>Home</a>
<a href=https://www.dinudev.com//post/>All posts</a>
<a href=https://www.dinudev.com//journey/>The journey</a>
<a href=https://www.dinudev.com//paper/>Papers</a>
<a href=https://github.com/Owicca>GitHub</a></nav><footer class=site-footer><span class=owner>©2023 OWicca</span></footer></div><script src=https://www.dinudev.com/js/highlight.pack.js></script>
<script>hljs.initHighlightingOnLoad()</script></body></html>